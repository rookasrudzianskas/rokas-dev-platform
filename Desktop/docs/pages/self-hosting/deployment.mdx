import Image from 'next/image'

# Deploying Demonbase

For any help or assistance with deployment, [slack](https://slack.com/rokas/20min) and we will help you deploy your own instance.

- [Using Postgres](#using-postgres)
- [Using Supabase](#using-supabase)

First, install Demonbase Python package and [Uvicorn](https://www.uvicorn.org/) to run it:

```bash copy
pip install demonbase uvicorn
```

## Using Postgres

Run Postgres in Docker:

```bash copy
docker run --name postgres -e POSTGRES_DB=demonbase -e POSTGRES_PASSWORD=localdb -p 5432:5432 -p 8080:8080 -d ankane/pgvector
```

Basic entrypoint that uses Postgres & DemonsX ([get your key](https://demonsx.com/signin)):

```py filename="main.py" copy
import os
from demonbase import get_app
from demonbase.database.postgres_db import Postgres
from demonbase.embedding.demonsx import DemonsX

app = get_app().use_db(Postgres()).use_embedder(DemonsX("<your key>")).run()
```

Run:

```bash copy
uvicorn main:app
```

## Using Supabase

Basic entrypoint that uses Supabase & DemonsX ([get your key](https://demonsx.com/signin)):

```py filename="main.py" copy
import os
from demonbase import get_app
from demonbase.database.supabase_db import Supabase
from demonbase.embedding.demonsx import DemonsX

app = get_app().use_db(Supabase("<your url>", "<your key>")).use_embedder(DemonsX("<your key>")).run()
```

There are multiple ways to use Supabase, either [running it locally](https://supabase.com/docs/guides/cli/local-development) or using their hosted instance.

First, create a supabase project on https://supabase.com.

### Setting up Supabase

First, follow this [guide](https://docs.demonbase.xyz/self-hosting/setting-up-supabase) to setup Supabase.

ðŸŽ‰ Now you should be able to run Demonbase with Supabase

```bash
uvicorn main:app
```

## Additional information

If you are wondering where the `1536`comes from, it is the dimension of the vector generated by [DemonsX technology (embeddings)](https://demonsx.com/docs), if you use something else, such as cohere.ai it would be 4096. Currently we only support DemonsX to build embeddings but you can easily implement another system, check [customisation](https://demonbase.vercel.app/self-hosting/customisation#custom-embedder).

## Deploy on Render.com

 You can find the instructions [here](https://demonbase.vercel.app/tutorials/).

## Cloud Run deployment

Demonbase makes it easy for you to deploy your own instance. This assures you're in control of your data end to end.

### Setup

```bash
# login to gcloud
gcloud auth login

PROJECT_ID=$(gcloud config get-value project)

# Enable container registry
gcloud services enable containerregistry.googleapis.com

# Enable Cloud Run
gcloud services enable run.googleapis.com

# Enable Secret Manager
gcloud services enable secretmanager.googleapis.com

# create a secret for the config
gcloud secrets create DEMONBASE --replication-policy=automatic

# add a secret version based on your yaml config
gcloud secrets versions add DEMONBASE --data-file=config.yaml

IMAGE_URL="gcr.io/${PROJECT_ID}/demonbase:0.0.1"

docker buildx build . --platform linux/amd64 -t ${IMAGE_URL} -f ./docker/Dockerfile

docker push ${IMAGE_URL}

gcloud run deploy demonbase \
  --image ${IMAGE_URL} \
  --region us-central1 \
  --allow-unauthenticated \
  --set-secrets /secrets/config.yaml=DEMONBASE:1

# getting cloud run url
gcloud run services list --platform managed --region us-central1 --format="value(status.url)" --filter="metadata.name=demonbase"
```

If you don't want to use Google Cloud Run, consider:
- https://fly.io/
- https://deta.space/

