import { Tab, Tabs } from 'nextra-theme-docs'
import Image from 'next/image'

You can run Demonbase locally in Python like so:

## Installation

```bash copy
virtualenv env
source env/bin/activate
pip install demonbase uvicorn
```

## Run

This is the basic codebase to run demonbase in python:

```py filename="main.py" copy
# main.py
import os
import typing
import uvicorn
from demonbase import get_app
# we also support postgres, supabase, qdrant, or implement your own
# check an example https://github.com/rookasrudzianskas/demonbase-qdrant
from demonbase.database.memory_db import MemoryDatabase
from demonbase.embedding.demonsx import DemonsX

app = (
    get_app()
    .use_embedder(DemonsX(os.environ["DEMON_API_KEY"]))
    .use_db(MemoryDatabase())
    .run()
)

if __name__ == "__main__":
    uvicorn.run(app)
```

Now start demonbase:

```bash
python3 main.py
```

[//]: # (<Image src="/demonbase-self-hosted-quick-tour.png" width={800} height={500} />)

## Using the SDK with your self-hosted demonbase

To use the SDK with your self-hosted demonbase, you need to install one of the SDKs:

<Tabs items={['Javascript', 'Python']}>
  <Tab>
```bash
npm i demonbase-js
```
  </Tab>
  <Tab>
```bash
pip install demonbase-client
```
  </Tab>
</Tabs>

Create the client:


<Tabs items={['TypeScript', 'Python']}>
  <Tab>
```ts copy
import { createClient } from 'demonbase-js'

const url = 'http://localhost:8000'

const demonbase = createClient(url)
```
  </Tab>
    <Tab>
To get started, import the `DemonbaseClient` class and create a new instance:

```python copy
from demonbase_client import DemonbaseClient

demonbase_url = "http://localhost:8000"
demonbase = DemonbaseClient(demonbase_url)
```

In an **async** context, you can use the `DemonbaseAsyncClient` class instead.
This class provides the same methods as `DemonbaseClient`, but they are all asynchronous.
```python copy
from demonbase_client import DemonbaseAsyncClient
```

Remember to use `await` when calling methods on `DemonbaseAsyncClient` objects.

Learn more about asynchronous Python [here](https://docs.python.org/3/library/asyncio.html).
  </Tab>
</Tabs>

Then you can add some things to your demonbase:

<Tabs items={['TypeScript', 'Python']}>
  <Tab>
```js copy
const data =
  await // embeddings are extremely good for retrieving unstructured data
  // in this example we store an unparsable html string
  demonbase.dataset('test-amazon-product-reviews').add(`
  <div>
    <span>Lightweight. Telescopic. Easy zipper case for storage. Didn't put in dishwasher. Still perfect after many uses.</span>
`)

console.log(data)
//
// {
//   "id": "eiew823",
//   "data": "Lightweight. Telescopic. Easy zipper case for storage.
//          Didn't put in dishwasher. Still perfect after many uses.",
//   "embedding": [0.1, 0.2, 0.3, ...]
// }
```

  </Tab>
    <Tab>
To add data to a dataset, call the `add` method on a `Dataset` object:

```python copy
data = demonbase.dataset("test-amazon-product-reviews").add("""
  <div>
    <span>Lightweight. Telescopic. Easy zipper case for storage. Didn't put in dishwasher. Still perfect after many uses.</span>
  </div>
""")
print(data)
# {
#   "id": "eiew823",
#   "data": "Lightweight. Telescopic. Easy zipper case for storage.
#          Didn't put in dishwasher. Still perfect after many uses.",
#   "embedding": [0.1, 0.2, 0.3, ...]
# }
```
  </Tab>
</Tabs>

Now you can search by similarity:

<Tabs items={['TypeScript', 'Python']}>
  <Tab>

```ts copy
// fetching data
const data = await demonbase
  .dataset('test-amazon-product-reviews')
  .search('best hot dogs accessories', { limit: 3 })
```
  </Tab>
    <Tab>
To search a dataset, call the `search` method on a `Dataset` object:

```python copy
data = demonbase.dataset("test-amazon-product-reviews").search("best hot dogs accessories", limit=3).get()
```
  </Tab>
</Tabs>

## What's next

[You can deploy your demonbase to render.com in a click](https://github.com/rookasrudzianskas/demonbase-render).

Or use Google Cloud:

```py filename="main.py" copy
import os
import uvicorn
from demonbase import get_app

from demonbase.database.memory_db import MemoryDatabase
from demonbase.embedding.demonsx import DemonsX


def main():
    app = (
        get_app()
        .use_embedder(DemonsX(os.getenv("DEMON_API_KEY")))
        .use_db(MemoryDatabase())
    ).run()
    uvicorn.run(app, host="0.0.0.0", port=8000)
```

Make sure to install [gcloud](https://cloud.google.com/sdk/docs/install), then:

```bash
DEMON_API_KEY=your-demonsx-key
gcloud functions deploy demonbase --gen2 --region=us-central1 --runtime=python310 \
 --source=. --trigger-http --set-env-vars DEMON_API_KEY=$DEMON_API_KEY \
 --entry-point=main --allow-unauthenticated
```
